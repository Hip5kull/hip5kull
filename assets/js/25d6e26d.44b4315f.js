"use strict";(self.webpackChunkgithub_page=self.webpackChunkgithub_page||[]).push([[737],{8698:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>l,metadata:()=>d,toc:()=>t});var i=s(4848),r=s(8453);const l={sidebar_position:1,id:"scripting-shell",title:"Scripting Shell",custom_edit_url:null},c="Scripting Shell",d={id:"Scripting/Bash/scripting-shell",title:"Scripting Shell",description:"- SCRIPTING SHELL",source:"@site/docs/Scripting/Bash/Scripting-Bash.md",sourceDirName:"Scripting/Bash",slug:"/Scripting/Bash/scripting-shell",permalink:"/hip5kull/docs/Scripting/Bash/scripting-shell",draft:!1,unlisted:!1,editUrl:null,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,id:"scripting-shell",title:"Scripting Shell",custom_edit_url:null},sidebar:"tutorialSidebar",previous:{title:"Installation Prometheus/Graphana",permalink:"/hip5kull/docs/Monitoring/Prometheus-Grafana"},next:{title:"AddUser Linux",permalink:"/hip5kull/docs/Scripting/Bash/adduser-linux"}},a={},t=[{value:"Le She bang",id:"le-she-bang",level:2},{value:"Les Commentaires",id:"les-commentaires",level:2},{value:"Fichier Executable",id:"fichier-executable",level:2},{value:"Debuguer",id:"debuguer",level:2},{value:"Commandes utiles en Script",id:"commandes-utiles-en-script",level:2},{value:"Les Variables",id:"les-variables",level:2},{value:"Modification du contenu d\u2019une variable d\u2019environnement",id:"modification-du-contenu-dune-variable-denvironnement",level:2},{value:"La commande set",id:"la-commande-set",level:2},{value:"La commande read",id:"la-commande-read",level:2},{value:"Les Encha\xeenements de commandes",id:"les-encha\xeenements-de-commandes",level:2},{value:"Inconditionnel",id:"inconditionnel",level:3},{value:"Conditionnel",id:"conditionnel",level:3},{value:"Regroupements de commandes",id:"regroupements-de-commandes",level:2},{value:"Regroupement avec cr\xe9ation de sous shell",id:"regroupement-avec-cr\xe9ation-de-sous-shell",level:3},{value:"Regroupement sans cr\xe9ation de sous shell",id:"regroupement-sans-cr\xe9ation-de-sous-shell",level:3},{value:"Les couleurs dans le shell",id:"les-couleurs-dans-le-shell",level:2},{value:"Execution Conditionn\xe9",id:"execution-conditionn\xe9",level:2},{value:"Les Boucles",id:"les-boucles",level:2},{value:"La boucle <em>while</em>",id:"la-boucle-while",level:3},{value:"Cas particulier des boucles infinies",id:"cas-particulier-des-boucles-infinies",level:4},{value:"La boucle <em>until</em>",id:"la-boucle-until",level:3},{value:"La boucle <em>for</em>",id:"la-boucle-for",level:3},{value:"Boucler pour un ensemble de valeurs",id:"boucler-pour-un-ensemble-de-valeurs",level:4},{value:"Exemples",id:"exemples",level:3},{value:"Les Fonctions",id:"les-fonctions",level:2},{value:"Syntaxe de d\xe9claration d&#39;une fonction",id:"syntaxe-de-d\xe9claration-dune-fonction",level:3},{value:"D\xe9claration et utilisation dans le script",id:"d\xe9claration-et-utilisation-dans-le-script",level:3},{value:"Les variables dans les fonctions",id:"les-variables-dans-les-fonctions",level:3},{value:"Passage de param\xe8tres aux fonctions",id:"passage-de-param\xe8tres-aux-fonctions",level:3},{value:"D\xe9claration dans un fichier ind\xe9pendant",id:"d\xe9claration-dans-un-fichier-ind\xe9pendant",level:3},{value:"Exemple",id:"exemple",level:3}];function o(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"scripting-shell",children:"Scripting Shell"}),"\n",(0,i.jsx)(n.h1,{id:"sommaire",children:"Sommaire"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#scripting-shell",children:"SCRIPTING SHELL"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#sommaire",children:"Sommaire"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#le-she-bang",children:"Le She bang"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#les-commentaires",children:"Les Commentaires"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#fichier-executable",children:"Fichier Executable"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#debuguer",children:"Debuguer"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#commandes-utiles-en-script",children:"Commandes utiles en Script"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#les-variables",children:"Les Variables"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#modification-du-contenu-dune-variable-denvironnement",children:"Modification du contenu d\u2019une variable d\u2019environnement"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#la-commande-set",children:"La commande set"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#la-commande-read",children:"La commande read"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#les-encha%C3%AEnements-de-commandes",children:"Les Encha\xeenements de commandes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#inconditionnel",children:"Inconditionnel"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#conditionnel",children:"Conditionnel"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#regroupements-de-commandes",children:"Regroupements de commandes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#regroupement-avec-cr%C3%A9ation-de-sous-shell",children:"Regroupement avec cr\xe9ation de sous shell"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#regroupement-sans-cr%C3%A9ation-de-sous-shell",children:"Regroupement sans cr\xe9ation de sous shell"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#les-couleurs-dans-le-shell",children:"Les couleurs dans le shell"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#execution-conditionn%C3%A9",children:"Execution Conditionn\xe9"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#les-boucles",children:"Les Boucles"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.a,{href:"#la-boucle-while",children:["La boucle ",(0,i.jsx)(n.em,{children:"while"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#cas-particulier-des-boucles-infinies",children:"Cas particulier des boucles infinies"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsxs)(n.a,{href:"#la-boucle-until",children:["La boucle ",(0,i.jsx)(n.em,{children:"until"})]})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.a,{href:"#la-boucle-for",children:["La boucle ",(0,i.jsx)(n.em,{children:"for"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#boucler-pour-un-ensemble-de-valeurs",children:"Boucler pour un ensemble de valeurs"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#exemples",children:"Exemples"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#les-fonctions",children:"Les Fonctions"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#syntaxe-de-d%C3%A9claration-dune-fonction",children:"Syntaxe de d\xe9claration d'une fonction"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#d%C3%A9claration-et-utilisation-dans-le-script",children:"D\xe9claration et utilisation dans le script"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#les-variables-dans-les-fonctions",children:"Les variables dans les fonctions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#passage-de-param%C3%A8tres-aux-fonctions",children:"Passage de param\xe8tres aux fonctions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#d%C3%A9claration-dans-un-fichier-ind%C3%A9pendant",children:"D\xe9claration dans un fichier ind\xe9pendant"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#exemple",children:"Exemple"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"le-she-bang",children:"Le She bang"}),"\n",(0,i.jsxs)(n.p,{children:["A chaque d\xe9but de script shell, il est n\xe9cessaire d'ajouter le shebang ",(0,i.jsx)(n.code,{children:"#!"})," suivi du shell choisi."]}),"\n",(0,i.jsx)(n.p,{children:"Afin d\u2019\xe9viter des erreurs, il est conseill\xe9 de sp\xe9cifier le Shell \xe0 utiliser\ngr\xe2ce au she bang."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Il est mat\xe9rialis\xe9 au moyen de la cha\xeene #! suivie du chemin du\nShell \xe0 utiliser (exemple : #!/bin/bash)."}),"\n",(0,i.jsx)(n.li,{children:"Il est possible d\u2019indiquer le SH, le KSH, le Python, le Perl, ou tout\nautre langage interpr\xe9t\xe9."}),"\n",(0,i.jsxs)(n.li,{children:["S\u2019assurer du chemin sp\xe9cifi\xe9, en utilisant par exemple la\ncommande ",(0,i.jsx)(n.code,{children:"which"})]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"#!/bin/bash\n"})}),"\n",(0,i.jsx)(n.h2,{id:"les-commentaires",children:"Les Commentaires"}),"\n",(0,i.jsxs)(n.p,{children:["L'ajout de commentaires dans un script permet d'am\xe9liorer sa lisibilit\xe9 par une tierce personne ou par nous-m\xeame ainsi que de commenter les modifications apporter.\nCes derniers sont pr\xe9c\xe9d\xe9s par un ",(0,i.jsx)(n.code,{children:"#"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"#!/bin/bash\n# ce script affiche la phrase \xab Hello World ! \xbb\necho Hello world ! # on peut commenter apr\xe8s une instruction\n"})}),"\n",(0,i.jsx)(n.p,{children:"Notez que le #Shebang n'est pas un commentaire."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"L\u2019affectation d\u2019un ent\xeate de script complet fait partie des bonnes\npratiques."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"#!/bin/bash\n#=======================================================\n#\n#\n# Ent\xeate de script - version: 1.0\n# \n# \n#=======================================================\n"})}),"\n",(0,i.jsx)(n.h2,{id:"fichier-executable",children:"Fichier Executable"}),"\n",(0,i.jsxs)(n.p,{children:["Pour qu'un script soit ex\xe9cutable il faut que ce dernier poss\xe8de la permission ",(0,i.jsx)(n.em,{children:(0,i.jsx)(n.code,{children:"execute"})})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"chmod +x script.sh\n"})}),"\n",(0,i.jsx)(n.h2,{id:"debuguer",children:"Debuguer"}),"\n",(0,i.jsx)(n.p,{children:"Les erreurs dans les scripts ne sont pas toujours faciles \xe0 rep\xe9rer.\nPlusieurs m\xe9thodes peuvent \xeatre utilis\xe9es afin de les identifier:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"L\u2019ex\xe9cution du script en mode trace permet d\u2019ex\xe9cuter une \xe0 une\nles commandes de celui-ci tout en les affichant pr\xe9c\xe9d\xe9es du\nsignal plus (+)."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"bash -x monscript.sh\n+ echo Hello world\nHello world\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"L\u2019int\xe9gration dans le script de commandes de d\xe9bogue se traduit par l\u2019ajout\ntemporaire de commandes permettant d\u2019analyser une situation.\nCela permet de contr\xf4ler le r\xe9sultat d\u2019ex\xe9cution de certaines parties du script et\nd\u2019identifier des sources potentielles de dysfonctionnement."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'echo "tapez votre nom"\nread nom\n## echo de debug avec pause : \necho "valeur de la variable nom : $nom"\nread # pause avant de poursuivre le d\xe9roulement du script\n## fin du debug\necho "Bienvenue $nom sur la machine $HOSTNAME"\n'})}),"\n",(0,i.jsx)(n.p,{children:"Les lignes de debug doivent \xeatre comment\xe9es avant la mise en production:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'echo "tapez votre nom"\nread nom\n## echo de debug avec pause : \n# echo "valeur de la variable nom : $nom"\n# read # pause avant de poursuivre le d\xe9roulement du script\n## fin du debug\necho "Bienvenue $nom sur la machine $HOSTNAME"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"commandes-utiles-en-script",children:"Commandes utiles en Script"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"echo"})," permet d\u2019afficher du texte."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'echo [option] "expression"\n'})}),"\n",(0,i.jsx)(n.p,{children:'Si "expression" contient des caract\xe8res sp\xe9ciaux, il faut la prot\xe9ger\navec des doubles quotes et lui ajouter l\u2019option \u2013e.\nOn peut de plus utiliser des options de mise en forme:'}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"\\c"})," inhibe le changement de ligne en fin de commande"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"\\n"})," nouvelle ligne"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"\\t"})," tabulation horizontale"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"\\\\"})," le caract\xe8re \\"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"clear"})," Commande simple sans argument, permettant d\u2019afficher une page \xe9cran vierge."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"exit [ n ]\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"n"})," est la valeur retourn\xe9e au Shell p\xe8re dans la variable ",(0,i.jsx)(n.code,{children:"$?"}),"\nUn script est g\xe9n\xe9ralement ex\xe9cut\xe9 dans un environnement enfant.\nCelui-ci peut se terminer par la commande \xab ",(0,i.jsx)(n.code,{children:"exit 0"})," \xbb ou non (dans ce cas, celle-ci est implicite)."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:"Lorsqu\u2019une commande interne est sp\xe9cifi\xe9e en argument, affiche\nl\u2019aide de la commande."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Afficher les commandes internes au Shell ",(0,i.jsx)(n.code,{children:"help"})]}),"\n",(0,i.jsxs)(n.li,{children:["Afficher l\u2019aide de la commande interne ",(0,i.jsx)(n.code,{children:"wait"}),": ",(0,i.jsx)(n.code,{children:"help wait"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"les-variables",children:"Les Variables"}),"\n",(0,i.jsx)(n.p,{children:"Les variables sont des \xe9l\xe9ments essentiels \xe0 la r\xe9alisation de scripts.\nElles permettent de stocker temporairement des informations au cours du d\xe9roulement du script\nCe contenu peut \xeatre affich\xe9 ou r\xe9utilis\xe9 par d\u2019autres commandes."}),"\n",(0,i.jsx)(n.p,{children:"Les variables peuvent \xeatre class\xe9es en 4 cat\xe9gories."}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Les variables locales"}),(0,i.jsx)(n.th,{children:"Les variables d'environnement"}),(0,i.jsx)(n.th,{children:"Les variables r\xe9serv\xe9es"}),(0,i.jsx)(n.th,{children:"Les constantes (variables en lecture seules)"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Les noms doivent \xeatre en minuscule (utilisation de doubles quotes \u201c pour s\xe9parer les mots.)"}),(0,i.jsx)(n.td,{children:"Variables syst\xe8mes comme HOME (ou variables export\xe9es)"}),(0,i.jsx)(n.td,{children:"Il est impossible d\u2019utiliser leurs noms pour des variables locales ou d\u2019environnement"}),(0,i.jsxs)(n.td,{children:["Variable en lecture seule via ",(0,i.jsx)(n.code,{children:"declare \u2013r <var>"}),". Leurs noms doivent \xeatre en majuscule (utilisation de \u201c_\u201d pour s\xe9parer les mots)"]})]})})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Une variable locale est utilisable dans l\u2019environnement courant."}),"\n",(0,i.jsxs)(n.li,{children:["Pour affecter un contenu \xe0 une variable : ",(0,i.jsx)(n.strong,{children:"nom=valeur"})]}),"\n",(0,i.jsxs)(n.li,{children:["Pour utiliser le contenu d\u2019une variable, on pr\xe9fixe son nom par le caract\xe8re dollar ",(0,i.jsx)(n.code,{children:"$"})," , g\xe9n\xe9ralement entour\xe9 de doubles quotes.\nUtilisation de variables locales"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'errormsg="une erreur est survenue, contactez votre \nadministrateur syst\xe8me"\nlogdir="/var/log/" \n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'[...]\necho "$errormsg"\nmkdir \u2013p "$logdir" 2>/dev/null\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Les variables r\xe9serv\xe9es"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Ce sont des variables dont le nom est r\xe9serv\xe9 par le Shell qui en g\xe8re le contenu.\nElles sont tr\xe8s utilis\xe9es dans les scripts et les encha\xeenements de commandes."}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Variables"}),(0,i.jsx)(n.th,{children:"Designations"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"$$"})}),(0,i.jsx)(n.td,{children:"Num\xe9ro du processus en cours"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"$?"})}),(0,i.jsx)(n.td,{children:"Code retour (0 si vrai, different de 0 si faux) exit 2 -> provoque la sortie avec le code retour \u201c2\u201d"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"$!"})}),(0,i.jsx)(n.td,{children:"Num\xe9ro du dernier processus lanc\xe9 en arri\xe8re-plan"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"$#"})}),(0,i.jsx)(n.td,{children:"Nombre de param\xe8tres re\xe7us par le script"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"$1"})," \xe0 ",(0,i.jsx)(n.code,{children:"$9"})]}),(0,i.jsx)(n.td,{children:"Param\xe8tres de la commande (1 pour le premier, 2 pour le deuxi\xe8me, etc.)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"$0"})}),(0,i.jsx)(n.td,{children:"Nom de la commande ou du script"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"$@"})}),(0,i.jsx)(n.td,{children:"ou $* Valeurs des param\xe8tres re\xe7us encadr\xe9s par \u201c \u201c . Certaines versions Unix concat\xe8nent les valeurs avec *"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"Exemple:"}),"\n",(0,i.jsxs)(n.p,{children:["./monscript.sh valun valdeux valtrois ",(0,i.jsx)(n.code,{children:"$#"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"$#"})," = 3 Trois param\xe8tres re\xe7us"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"$0"})," = ./monscript.sh"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"$1"})," = valun"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"$2"})," = valdeux"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"$3"})," = valtrois"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"$@"})," = valun valdeux valtrois"]}),"\n",(0,i.jsx)(n.h2,{id:"modification-du-contenu-dune-variable-denvironnement",children:"Modification du contenu d\u2019une variable d\u2019environnement"}),"\n",(0,i.jsx)(n.p,{children:"Une variable d\u2019environnement est une variable qui est h\xe9rit\xe9e dans\ntous les sous-Shell.\nPour cr\xe9er une variable d\u2019environnement, on peut :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"soit exporter une variable locale"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"export NOMVAR\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"soit cr\xe9er (ou modifier) et exporter directement une nouvelle variable"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"export NOMVAR=valeur\n"})}),"\n",(0,i.jsx)(n.h2,{id:"la-commande-set",children:"La commande set"}),"\n",(0,i.jsxs)(n.p,{children:["La commande ",(0,i.jsx)(n.code,{children:"set"})," permet notamment d\u2019affecter des valeurs aux variables r\xe9serv\xe9es 1, 2 ..."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'set "$LOGNAME" $(uname -n)\necho "$1 $2"\nuser20 serveur102\n'})}),"\n",(0,i.jsx)(n.p,{children:"Si aucun argument n\u2019est donn\xe9, toutes les variables du Shell sont affich\xe9es."}),"\n",(0,i.jsx)(n.h2,{id:"la-commande-read",children:"La commande read"}),"\n",(0,i.jsx)(n.p,{children:"La commande read est utilis\xe9e pour affecter un contenu saisi par l\u2019utilisateur \xe0 une variable."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"read [option] <variable(s)>\n"})}),"\n",(0,i.jsx)(n.p,{children:"Cette commande g\xe9n\xe8re l\u2019attente de saisie clavier valid\xe9e (par Entr\xe9e) et proc\xe8de au stockage de cette saisie dans la (ou les) variable(s) sp\xe9cifi\xe9e(s)."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'echo "Veuillez entrer votre nom : "\nread nom\necho "Bonjour $nom"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Il est possible de substituer la commande echo par l\u2019option ",(0,i.jsx)(n.code,{children:"\u2013p"})," de ",(0,i.jsx)(n.code,{children:"read"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'read \u2013p "Veuillez entrer votre nom : " nom\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Si plusieurs param\xe8tres s\xe9par\xe9s par des espaces sont fournis \xe0 ",(0,i.jsx)(n.code,{children:"read"}),", alors chaque mot saisi est affect\xe9 \xe0 la variable correspondante.\nLes saisies en surnombre sont affect\xe9es au dernier nom de variable indiqu\xe9."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'read \u2013p " Saisissez votre nom et pr\xe9nom : " nom prenom\nDupont Jean dit toto\necho "Nom saisi : $nom "\nNom saisi : Dupont\necho "Pr\xe9nom saisi : $prenom "\nPr\xe9nom saisi : Jean dit toto\n'})}),"\n",(0,i.jsx)(n.p,{children:"Pour \xe9viter ce type de d\xe9sagr\xe9ment, il est possible de d\xe9clarer une variable tampon non utilis\xe9e."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'read \u2013p " Saisissez votre nom et pr\xe9nom : " nom prenom tampon\nDupont Jean dit toto\n[\u2026]\necho "Pr\xe9nom saisi : $prenom "\nPr\xe9nom saisi : Jean\n'})}),"\n",(0,i.jsx)(n.p,{children:"Il est \xe9ventuellement possible ult\xe9rieurement de d\xe9truire cette\nvariable tampon"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"unset tampon\n"})}),"\n",(0,i.jsx)(n.h2,{id:"les-encha\xeenements-de-commandes",children:"Les Encha\xeenements de commandes"}),"\n",(0,i.jsx)(n.h3,{id:"inconditionnel",children:"Inconditionnel"}),"\n",(0,i.jsxs)(n.p,{children:["Pour encha\xeener des commandes quel que soit le r\xe9sultat de leur ex\xe9cution, on utilise le ",(0,i.jsx)(n.code,{children:";"})," entre celles-ci."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"mkdir /data ; touch /data/file1 ; cat /home/bonjour.txt\nmkdir: cannot create directory `./data': Permission denied\ntouch: cannot touch `./data/file1': No such file or directory\nBonjour le monde !\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Dans cet exemple, l'utilisateur n'a pas le droit de cr\xe9er un r\xe9pertoire \xe0 la racine.\nLa commande de cr\xe9ation d'un ficbhier dans le r\xe9pertoire \xe9choue aussi.\nLa derni\xe8re commande (sans lien avec les pr\xe9c\xe9dentes) aboutit.\nDans un script, le traitement des commandes est s\xe9quentiel.\nLe ",(0,i.jsx)(n.code,{children:";"})," est substitu\xe9 par un retour \xe0 la ligne."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"mkdir /data ; touch /data/file1 ; cat /home/bonjour.txt\n"})}),"\n",(0,i.jsx)(n.p,{children:"Donne:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"mkdir /data\ntouch /data/file1\ncat /home/bonjour.txt\n"})}),"\n",(0,i.jsx)(n.h3,{id:"conditionnel",children:"Conditionnel"}),"\n",(0,i.jsxs)(n.p,{children:["L\u2019op\xe9rateur ",(0,i.jsx)(n.code,{children:"&&"})," conditionne l\u2019encha\xeenement de commandes au r\xe9sultat d\u2019ex\xe9cution positif de la commande pr\xe9c\xe9dente."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Cette structure peut se traduire par :\nSi la ",(0,i.jsx)(n.strong,{children:"commande aboutit alors"})," je fais la suivante."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"mkdir /data && touch /data/file1\nmkdir: cannot create directory `./data': Permission denied\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"mkdir ./data && touch ./data/file1\nls -l ./data/\n-rw-r--r-- 1 Toto Toto 0 2021-12-26 02:12 file1\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Le syst\xe8me s\u2019appuie sur le code retour de la commande pr\xe9c\xe9dente (variable r\xe9serv\xe9e ",(0,i.jsx)(n.code,{children:"$?"}),") :\nSi ",(0,i.jsx)(n.code,{children:"$?"})," = ",(0,i.jsx)(n.code,{children:"0"})," (pas d\u2019erreur) : alors la commande suivante est ex\xe9cut\xe9e\nSi ",(0,i.jsx)(n.code,{children:"$?"})," \u2260 ",(0,i.jsx)(n.code,{children:"0"})," (erreur) : alors la commande suivante n\u2019est pas ex\xe9cut\xe9e"]}),"\n",(0,i.jsxs)(n.p,{children:["L\u2019op\xe9rateur ",(0,i.jsx)(n.code,{children:"||"})," conditionne l\u2019encha\xeenement de commandes \xe0 l\u2019\xe9chec d\u2019ex\xe9cution de la commande pr\xe9c\xe9dente."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Cette structure peut se traduire par :\nSi la ",(0,i.jsx)(n.strong,{children:"commande n\u2019a pas abouti alors"})," je fais la suivante."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"mkdir ./data 2>/dev/null || echo \"Erreur de cr\xe9ation du \nr\xe9pertoire 'data'\"\nErreur de cr\xe9ation du r\xe9pertoire 'data'\n"})}),"\n",(0,i.jsx)(n.h2,{id:"regroupements-de-commandes",children:"Regroupements de commandes"}),"\n",(0,i.jsx)(n.p,{children:"Les regroupements de commandes peuvent \xeatre utilis\xe9s pour:\nExecuter plusieurs commandes dans un m\xeame environnement.\nRediriger le r\xe9sultat de plusieurs commandes vers un fichier ou un tube."}),"\n",(0,i.jsx)(n.h3,{id:"regroupement-avec-cr\xe9ation-de-sous-shell",children:"Regroupement avec cr\xe9ation de sous shell"}),"\n",(0,i.jsxs)(n.p,{children:["Deux syntaxes de regroupement de commandes sont utilisables:\n",(0,i.jsx)(n.code,{children:"("}),"regroupement parenth\xe8ses",(0,i.jsx)(n.code,{children:")"})," et ",(0,i.jsx)(n.code,{children:"{"}),"regroupement accolade",(0,i.jsx)(n.code,{children:"}"})]}),"\n",(0,i.jsx)(n.p,{children:"Pour regrouper dans un environnement enfant l\u2019ex\xe9cution de plusieurs commandes, on utilise la syntaxe suivante :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"(cmd1 ; cmd2)\n"})}),"\n",(0,i.jsx)(n.p,{children:"Pour plus de lisibilit\xe9, nous \xe9crirons ainsi:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"(\n    cmd1\n    cmd2\n)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"regroupement-sans-cr\xe9ation-de-sous-shell",children:"Regroupement sans cr\xe9ation de sous shell"}),"\n",(0,i.jsx)(n.p,{children:"Pour regrouper dans un environnement enfant l\u2019ex\xe9cution de plusieurs commandes, on utilise la syntaxe suivante :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"{cmd1 ; cmd2}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Pour plus de lisibilit\xe9, nous \xe9crirons ainsi:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"{\n    cmd1\n    cmd2\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"les-couleurs-dans-le-shell",children:"Les couleurs dans le shell"}),"\n",(0,i.jsx)(n.p,{children:"Il est possible d'utiliser quelques couleurs dans le shell ou dans les scripts.\nElles peuvent \xeatre utiles pour mettre en valeur des informations importantes."}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Couleur"}),(0,i.jsx)(n.th,{children:"Caract\xe8res"}),(0,i.jsx)(n.th,{children:"Fond"}),(0,i.jsx)(n.th,{}),(0,i.jsx)(n.th,{children:"Attribut des caract\xe8res"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Noir"}),(0,i.jsx)(n.td,{children:"30"}),(0,i.jsx)(n.td,{children:"40"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:"0 : Aucun"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Rouge"}),(0,i.jsx)(n.td,{children:"31"}),(0,i.jsx)(n.td,{children:"41"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:"1 : Gras"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Vert"}),(0,i.jsx)(n.td,{children:"32"}),(0,i.jsx)(n.td,{children:"42"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:"2 : Soulign\xe9"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Jaune"}),(0,i.jsx)(n.td,{children:"33"}),(0,i.jsx)(n.td,{children:"43"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:"7 : Invers\xe9"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Bleu"}),(0,i.jsx)(n.td,{children:"34"}),(0,i.jsx)(n.td,{children:"44"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:"8 : Invisible"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Magenta"}),(0,i.jsx)(n.td,{children:"35"}),(0,i.jsx)(n.td,{children:"45"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{children:"9 : Barr\xe9"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Cyan"}),(0,i.jsx)(n.td,{children:"36"}),(0,i.jsx)(n.td,{children:"46"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Gris Clair"}),(0,i.jsx)(n.td,{children:"37"}),(0,i.jsx)(n.td,{children:"47"}),(0,i.jsx)(n.td,{}),(0,i.jsx)(n.td,{})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Pour coloriser une information, les codes couleur seront \xe0 encadrer\npour :\nAnnoncer la couleur : ",(0,i.jsx)(n.code,{children:"\\033["})," ou ",(0,i.jsx)(n.code,{children:"\\e["}),"\nFinir la d\xe9finition de couleur : ",(0,i.jsx)(n.code,{children:"m"}),"\nRemettre la valeur initiale : ",(0,i.jsx)(n.code,{children:"\\033[0m"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'echo -e "voici du \\033[1;32mvert\\033[0m"\nvoici du vert\n'})}),"\n",(0,i.jsx)(n.h2,{id:"execution-conditionn\xe9",children:"Execution Conditionn\xe9"}),"\n",(0,i.jsx)(n.p,{children:"Dans de nombreux cas pratiques, la r\xe9alisations d'actions est conditionn\xe9e."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Exemple: La valeur de la variable ",(0,i.jsx)(n.code,{children:"nb"})," est conditionn\xe9e","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Au nombre d'arguments pass\xe9 au script"}),"\n",(0,i.jsx)(n.li,{children:"Puis \xe0 la pr\xe9sence ou non de contenu dans cette variable."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["En Scripting Shell, pour traduire cet algorithme, nous utiliserons:\nUne structure de contr\xf4le comme la structure ",(0,i.jsx)(n.code,{children:"if"}),"\nUne expression de test (qui sera int\xe9gr\xe9e) \xe0 la structure de contr\xf4le.\nAinsi, la premi\xe8re condition serait traduite ainsi:\nStructure de contr\xf4le de ",(0,i.jsx)(n.code,{children:"if"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"if condition ;then\n    nb=$1\nfi\n"})}),"\n",(0,i.jsx)(n.p,{children:"Test de la condition:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"[[ $nbarg \u2013eq 1 ]]\n"})}),"\n",(0,i.jsx)(n.p,{children:"Structure compl\xe8te:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"if [[ $nbarg \u2013eq 1 ]] ; then\nnb=$1\nfi\n"})}),"\n",(0,i.jsxs)(n.p,{children:["L'instruction ",(0,i.jsx)(n.code,{children:"if"}),"est utilis\xe9e pour structurer la r\xe9alisation conditionn\xe9e de commandes."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"si\n    la condition est remplie\n    alors je fais ceci\n    sinon je fais cela\nfin du si\n"})}),"\n",(0,i.jsx)(n.p,{children:"Cette instruction requiert au minimum :"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Un d\xe9but : ",(0,i.jsx)(n.code,{children:"if"})]}),"\n",(0,i.jsx)(n.li,{children:"L\u2019ex\xe9cution d\u2019une commande (un test de condition par exemple)"}),"\n",(0,i.jsxs)(n.li,{children:["L\u2019ex\xe9cution d\u2019au moins une action si la condition est v\xe9rifi\xe9e : ",(0,i.jsx)(n.code,{children:"then"})]}),"\n",(0,i.jsxs)(n.li,{children:["Une fin : ",(0,i.jsx)(n.code,{children:"fi"}),"\nCette instruction peut \xeatre compl\xe9t\xe9e par:"]}),"\n",(0,i.jsx)(n.li,{children:"L'ex\xe9cution d'autres actions si la condition est v\xe9rifi\xe9e"}),"\n",(0,i.jsxs)(n.li,{children:["L'ex\xe9cution d'actions \xe0 r\xe9aliser si la condition n'est pas v\xe9rifi\xe9e: ",(0,i.jsx)(n.code,{children:"else"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Exemples:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'if [[ "$LOGNAME" = root ]] ; then\necho "Ne pas se connecter en root"\nfi\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'if ls /tmp ; then\necho "/tmp existe"\nfi\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'if [[ "$LOGNAME" = root ]] ; then\necho "Ne pas se connecter en root"\nelse\necho "Bienvenue sur la machine $HOSTNAME"\nfi\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'if [[ "$LOGNAME" = root ]] ; then\necho "Ne pas se connecter en root"\necho "Le script va quitter"\nexit 1\nelse\necho "Bienvenue sur la machine $HOSTNAME"\necho "Le script continue"\nfi\n'})}),"\n",(0,i.jsxs)(n.p,{children:["L'imbrication du ",(0,i.jsx)(n.code,{children:"if"})," :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"if <condition> ; then \n    <action>\nelse\n    if <condition> ; then\n        <action>\n    else\n<       action>\n    fi # fin du second if\nfi # fin du premier if\n"})}),"\n",(0,i.jsxs)(n.p,{children:["L'utilisation du ",(0,i.jsx)(n.code,{children:"elif"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"if <condition> ; then \n    <action>\nelif <condition> ; then\n    <action>\nelse\n    <action>\nfi # fin commune des 2 if\n"})}),"\n",(0,i.jsx)(n.h2,{id:"les-boucles",children:"Les Boucles"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Une boucle est une structure permettant de r\xe9p\xe9ter plusieurs fois un m\xeame bloc d\u2019actions."}),"\n",(0,i.jsx)(n.li,{children:"Le nombre de fois \xe0 ex\xe9cuter le bloc d\u2019actions peut \xeatre d\xe9termin\xe9 par une condition ou une liste d\u2019objets \xe0 traiter."}),"\n",(0,i.jsx)(n.li,{children:"Quand il s\u2019agit d\u2019une condition, penser \xe0 faire \xe9voluer la valeur des variables utilis\xe9es dans celle-ci (notamment au moyen de calcul)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"expr"}),": Calcul arithm\xe9tique"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Les arguments pass\xe9s \xe0 la commande peuvent \xeatre des entiers ou des variables (contenant des entiers)."}),"\n",(0,i.jsx)(n.li,{children:"Chaque op\xe9rateur doit \xeatre pr\xe9c\xe9d\xe9 et suivi d\u2019un espace."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"expr 2 + 7\n9\nexpr 2 \\* 7\n14\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Les commandes ",(0,i.jsx)(n.code,{children:"let"})," et ",(0,i.jsx)(n.code,{children:"((\u2026))"})," peuvent \xeatre utilis\xe9es en remplacement de la commande ",(0,i.jsx)(n.code,{children:"expr"}),"."]}),"\n",(0,i.jsxs)(n.h3,{id:"la-boucle-while",children:["La boucle ",(0,i.jsx)(n.em,{children:"while"})]}),"\n",(0,i.jsx)(n.p,{children:"Structure de bouclage bas\xe9e sur une condition atteinte : tant que\nla condition est atteinte, on effectue le bloc d\u2019actions."}),"\n",(0,i.jsx)(n.p,{children:"Exemple:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'while [[ -z "$nom" ]] ; do\necho -e "Veuillez entrer votre nom : \\c"\nread nom\ndone\necho "Bonjour $nom"\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"La structure while analyse le code retour de la condition pour d\xe9terminer si le bloc d\u2019actions est \xe0 ex\xe9cuter ou s\u2019il doit sortir de la boucle."}),"\n",(0,i.jsx)(n.li,{children:"G\xe9n\xe9ralement, la condition se mat\xe9rialise par une commande de test."}),"\n",(0,i.jsx)(n.li,{children:"On agit alors dans le bloc d\u2019actions afin de faire \xe9voluer le r\xe9sultat du test."}),"\n",(0,i.jsx)(n.li,{children:"Cependant, toute commande peut \xeatre utilis\xe9e en condition (tant que son code retour est \xab 0 \xbb, on reste dans la boucle)."}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"cas-particulier-des-boucles-infinies",children:"Cas particulier des boucles infinies"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Pour g\xe9n\xe9rer une boucle infinie, on utilise la commande ",(0,i.jsx)(n.code,{children:"true"})," ou ",(0,i.jsx)(n.code,{children:":"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Les boucles infinies sont notamment utilis\xe9es pour la cr\xe9ation de menus."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Exemple:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'while true ; do\n    echo menu # Affichage du menu\n    echo "1) copie des fichiers"\n    echo "2) restauration des fichiers"\n    echo "q) Quitter"\n    # R\xe9cup\xe9rer la saisie de l\'utilisateur dans $choix\n    read -p "Taper 1, 2 ou q pour continuer : " choix\n    # Tester la valeur de $choix\n    case $choix in\n        1) echo copie des fichiers; [\u2026] ;;\n        2) echo restauration des fichiers; [\u2026] ;;\n        q) clear ; exit 0 ;;\n        *) echo -e "\\e[41msaisie incorrecte \\e[0m" ;;\n    esac\ndone\n\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"la-boucle-until",children:["La boucle ",(0,i.jsx)(n.em,{children:"until"})]}),"\n",(0,i.jsxs)(n.p,{children:["Structure bas\xe9e sur une condition \xe0 atteindre : tant que la condition n\u2019est pas atteinte, on effectue un bloc d\u2019actions.\nLa v\xe9rification de la condition m\xe8ne \xe0 la sortie de la boucle.\nLa structure ",(0,i.jsx)(n.code,{children:"until"})," et son mode de fonctionnement sont identiques \xe0 la boucle ",(0,i.jsx)(n.code,{children:"while"}),". Seule la condition de bouclage les diff\xe9rencie.\nPour faire une boucle infinie avec ",(0,i.jsx)(n.code,{children:"until"}),", il est possible d\u2019utiliser la commande ",(0,i.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'until [[ -n "$age" ]] ; do\n    echo -e "Saisissez votre age : \\c"\n    read age\ndone\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"la-boucle-for",children:["La boucle ",(0,i.jsx)(n.em,{children:"for"})]}),"\n",(0,i.jsxs)(n.p,{children:["La boucle ",(0,i.jsx)(n.code,{children:"for"})," peut boucle:\nPour un ensemble de valeurs \xe0 traiter\nUn nombre de fois pr\xe9d\xe9termin\xe9"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"La syntaxe d\u2019utilisation suivante permet de boucler pour un\nensemble de valeurs \xe0 traiter."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"for element in LISTE DE VALEURS ; do\n    ACTIONS\ndone\n\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Lors du premier passage dans la boucle, la valeur affect\xe9e \xe0 la\nvariable d\xe9finie ",(0,i.jsx)(n.code,{children:"$element"})," sera la premi\xe8re valeur de la liste :\n\xab ",(0,i.jsx)(n.code,{children:"LISTE"})," \xbb."]}),"\n",(0,i.jsxs)(n.li,{children:["Lors du second passage, ",(0,i.jsx)(n.code,{children:"$variable"})," contiendra \xab ",(0,i.jsx)(n.code,{children:"DE"})," \xbb et ainsi de\nsuite jusqu\u2019\xe0 ce que les valeurs aient \xe9t\xe9 trait\xe9es."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"boucler-pour-un-ensemble-de-valeurs",children:"Boucler pour un ensemble de valeurs"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'$ for valeurs in "petit exemple" de "boucle for" ; do\n>echo "Entr\xe9e dans le bloc d\u2019actions de la boucle"\n>echo "contenu de la variable valeurs : $valeurs"\n>done\nEntr\xe9e dans le bloc d\u2019actions de la boucle\ncontenu de la variable valeurs : petit exemple\nEntr\xe9e dans le bloc d\u2019actions de la boucle\ncontenu de la variable valeurs : de\nEntr\xe9e dans le bloc d\u2019actions de la boucle\ncontenu de la variable valeurs : boucle for\n'})}),"\n",(0,i.jsxs)(n.p,{children:["La liste de valeurs est int\xe9pr\xe9t\xe9e par le shell.\nLa liste des caract\xe8res de s\xe9paration de champs entre les diff\xe9rentes valeurs est r\xe9cup\xe9r\xe9e depuis la variable d'environnement ",(0,i.jsx)(n.code,{children:"IFS"})," (Internal Field Separator).\nIl est parfois utile de modifier cette valeur."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"$ set | grep ^IFS\nIFS=$' \\t\\n'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"exemples",children:"Exemples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'cat fic | while read nom ; do\n    if [[ "$nom" = toto ]] ; then\n        echo "$nom"\n            read -p "message : " choix </dev/tty\n            echo "$choix"\n    fi\ndone\n'})}),"\n",(0,i.jsx)(n.p,{children:"Liste et Calcule le nombre et pourcentage de dossier/fichier pr\xe9sents dans un dossier selon un fichier d'extensions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'if [[ $# -ne 2 ]]; then\n      echo -e " Syntaxe: $0 <Chemin du dossier \xe0 traiter> <Fichiers extensions>" \n      exit 1\nfi\n\ndossier=$1 #Variable Chemin \xe0 traiter\nfichier=$2 #Variable fichier extensions\n\nif [[ -f $2 ]]; then    # V\xe9rification de la pr\xe9sence des 2 arguments\n      nbfiles=$(ls ${dossier} | wc -l ) # Liste et compte le nombre de fichier dans le dossier\n      echo -e "Nombre total de fichier dans $(basename "$dossier") : ${nbfiles}"\n\n    nbdirs=$(find "${dossier}" -type d | wc -l) # Liste et Compte le nombre de dossier et calcule le pourcentage\n    pourcentage_dirs=$(echo "scale=2; ${nbdirs} * 100 / ${nbfiles}" | bc)\n    echo ""\n    echo -e "Nombre total de dossiers dans le dossier $(basename "$dossier") : ${nbdirs}"\n    echo ""\n    echo -e "${pourcentage_dirs}% des fichiers du r\xe9pertoire $(basename "$dossier") sont des dossiers\\n"\n\n      for ext in $(cat ${fichier}) # Boucle for pour chaque fichier, trouver les occurences des extensions\n        do\n            nbficext=$(ls ${dossier}/*.${ext} 2>/dev/null | wc -w) # Liste et compte le nombre de fichier\n            if [[ ${nbficext} -gt 0 ]]; then # Si sup\xe9rieur \xe0 0 alors\n                echo "----------------------"\n                echo -e "${ext}"\n                echo "----------------------"\n                echo "-> ${nbficext} fichiers ${ext}"\n\t\t\t\tpourcentage=$(expr ${nbficext} \\* 100 \\/ ${nbfiles})\n\t\t\t\techo "-> $pourcentage% des fichiers du r\xe9pertoire $(basename "$dossier")"\n            else\n                echo "----------------------"\n                echo -e "${ext}"\n                echo "----------------------"\n                echo -e " Aucun fichier ${ext} dans $(basename "$dossier")"\n            fi\n        done\nelse\n    echo " Le fichier ${fichier} contenant les extensions n\'a pas \xe9t\xe9 trouv\xe9. "\n    exit 2\nfi\n'})}),"\n",(0,i.jsx)(n.p,{children:"Calculateur d'ann\xe9e bissextile selon une plage d'ann\xe9e"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'echo -e " ----\\e[1mCalculateur de nombre d\'ann\xe9es bissextiles\\e[0m---- "\necho ""\nread -p "Entrez l\'ann\xe9e de d\xe9but : " debut\nread -p "Entrez l\'ann\xe9e de fin : " fin\n\ncount=0\n\nfor ((i=debut;i<=fin;i++))\ndo\n    if [ $((i%4)) -eq 0 ] && [ $((i%100)) -ne 0 ] || [ $((i%400)) -eq 0 ]\n    then\n        ((count++))\n    fi\ndone\n\necho "Il y a $count ann\xe9es bissextiles entre $debut et $fin."\n'})}),"\n",(0,i.jsx)(n.p,{children:"Script int\xe9ractif de cr\xe9ation, modification, suppression et v\xe9rification d'un compte utilisateur"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'if [[ $EUID -ne 0 ]]; then\n   echo "Ce script doit \xeatre ex\xe9cut\xe9 en tant que root." \n   exit 1\nfi\n\nwhile true; do\necho -n " Saisir le compte utilisateur souhait\xe9: "\nread user\n\nif [[ "${user,,}" = "q" ]]; then\n        echo "Au revoir !"\n        exit 0\nfi\n\necho ""\necho " GESTION DES UTILISATEURS: $user "\necho " _____________________________ "\necho ""\necho " C - Cr\xe9er le compte utilisateur "\necho " M - Modifier le mot de passe utilisateur "\necho " S - Supprimer le compte utilisateur "\necho " V - V\xe9rifier si le compte utilisateur existe "\necho ""\necho " Q - Quitter "\necho ""\necho -n " Veuillez saisir votre choix: "\nread choix\n\necho ""\ncase $choix in\n    c|C)\n    if useradd -m -s /usr/bin/zsh $user ; then\n        echo -e " Le compte $user a \xe9t\xe9 cr\xe9\xe9 "\n    fi\n    ;;\n    m|M)\n    if passwd $user ; then\n    echo -e "Modification du mot de passe de $user avec succ\xe8s."\n    fi\n    ;;\n    s|S)\n    if deluser --remove-home $user ; then\n        echo -e " Suppression du compte avec succ\xe8s. "\n    fi\n    ;;\n    v|V)\n        echo "Verification de l\'existence du compte"\n        if grep -qi "$user" /etc/passwd; then\n            echo -e " Compte utilisateur $user \\033[1;32mEXISTANT \\033[0m "\n            echo ""\n        else\n            echo -e " Compte utilisateur $user \\033[1;31mINEXISTANT \\033[0m "\n            echo ""\n        fi\n    ;;\n    q|Q)\n        exit 0\n    ;;\n    *)\n        echo " Choix non pris en charge. Saississez: C ; M ; S ; V ou Q "\n    ;;\nesac\n\ndone\n'})}),"\n",(0,i.jsx)(n.p,{children:"R\xe9cup\xe8re et affiche sous forme de tableau les users pr\xe9sents dans /etc/passwd"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'while IFS=: read -r user uid gid desc home shell; do\n    uid=$(echo "$user" | awk \'{print $1}\')\n    home=$(echo "$user" | grep \'/home\')\n\n    if [[ -n "$home" ]]\n    then\n        desc=$(echo "$user" | awk -F: \'{print $5}\')\n        shell=$(echo "$user" | awk \'{print $7}\')\n\n        echo "---------------------------------"\n        echo " Identifiant : $uid "\n        echo "- - - - - - - - - - - - - - - - - - - - -"\n        echo "UID : $(id -u "$uid") GID : $(id -g "$uid")"\n        if [[ -n "$desc" ]]\n        then\n            echo "Description : $desc"\n        fi\n        echo "R\xe9pertoire personnel : $home"\n        echo "Shell : $shell"\n    fi\ndone < <(cat /etc/passwd | sed -e \'s/::/:x:/g\' -e \'s/:/\\ /g\')\n'})}),"\n",(0,i.jsx)(n.h2,{id:"les-fonctions",children:"Les Fonctions"}),"\n",(0,i.jsx)(n.p,{children:"Les fonctions permettent de regrouper plusieurs commandes qui pourront \xeatre ex\xe9cut\xe9es de fa\xe7on r\xe9guli\xe8re durant le script."}),"\n",(0,i.jsxs)(n.p,{children:["Il est conseill\xe9 d\u2019utiliser des minuscules dans le nom des fonctions et de pr\xe9fixer le nom de la fonction avec le terme \xab ",(0,i.jsx)(n.code,{children:"function_"})," \xbb ou \xab ",(0,i.jsx)(n.code,{children:"func_"})," \xbb suivi du nom r\xe9el de la fonction."]}),"\n",(0,i.jsx)(n.p,{children:"Cela permet de lire le script plus facilement et savoir quand on fait appel \xe0 une fonction ou \xe0 une commande."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"La mise en \u0153uvre de fonction se fait en deux \xe9tapes :"}),"\n",(0,i.jsx)(n.li,{children:"D\xe9claration de la fonction et de son contenu"}),"\n",(0,i.jsx)(n.li,{children:"Appel de la fonction"}),"\n",(0,i.jsx)(n.li,{children:"Les d\xe9clarations de fonctions peuvent \xeatre stock\xe9es dans un fichier s\xe9par\xe9, pour rendre un script plus lisible et les r\xe9utiliser dans d\u2019autres scripts."}),"\n",(0,i.jsx)(n.li,{children:"Les fonctions peuvent \xeatre invoqu\xe9es avec des param\xe8tres, comme les commandes et les scripts."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"syntaxe-de-d\xe9claration-dune-fonction",children:"Syntaxe de d\xe9claration d'une fonction"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"nomfonction()\n{\nACTIONS\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"d\xe9claration-et-utilisation-dans-le-script",children:"D\xe9claration et utilisation dans le script"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'#!/bin/bash\nfunc_infos() {\n    echo "Informations sur la distribution utilis\xe9e"\n    lsb_release -dric\n}\n# Afficher les infos sur l\u2019OS\nfunc_infos\n'})}),"\n",(0,i.jsx)(n.h3,{id:"les-variables-dans-les-fonctions",children:"Les variables dans les fonctions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'#!/bin/bash\nnbr=50\nfunc_majnbr () {\n    nbr=100\n}\necho "variable nbr avant fonction: $nbr"\nfunc_majnbr\necho "variable nbr apr\xe8s fonction : $nbr"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"passage-de-param\xe8tres-aux-fonctions",children:"Passage de param\xe8tres aux fonctions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'#!/bin/bash\nfunc_accueil () {\n    echo "Message d\u2019accueil :"\n    echo "Bonjour $1 $2"\n    echo "Bienvenue sur la machine $HOSTNAME"\n}\nread -p "Entrez votre pr\xe9nom nom (ex Marc Dubois) : " prenom nom\nfunc_accueil "$prenom" "$nom"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"d\xe9claration-dans-un-fichier-ind\xe9pendant",children:"D\xe9claration dans un fichier ind\xe9pendant"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Les fonctions peuvent \xeatre d\xe9finies dans un fichier indnt du script."}),"\n",(0,i.jsxs)(n.li,{children:["Il suffit ensuite d\u2019appeler le fichier avec les commandes ",(0,i.jsx)(n.code,{children:"source"})," ou \xab . \xbb (point), afin que le contenu de ce fichier soit interpr\xe9t\xe9 dans l\u2019environnement d\u2019ex\xe9cution courant."]}),"\n",(0,i.jsx)(n.li,{children:"Avantages de sortir les fonctions des scripts :"}),"\n",(0,i.jsx)(n.li,{children:"Le script est plus lisible (\u2026 ou pas, en fonction des cas)"}),"\n",(0,i.jsx)(n.li,{children:"Le script est plus facile \xe0 d\xe9boguer"}),"\n",(0,i.jsx)(n.li,{children:"Les fonctions peuvent \xeatre utilis\xe9es par d\u2019autres scripts"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Contenu du fichier de fonctions \xab mesfonctions \xbb:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'func_accueil () {\necho "Message d\u2019accueil :"\necho "Bonjour $1 $2"\necho "Bienvenue sur la machine $HOSTNAME"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Le fichier de fonction n\u2019a pas besoin d\u2019\xeatre ex\xe9cutable, des\nprivil\xe8ges de lecture suffisent."}),"\n",(0,i.jsx)(n.p,{children:"Contenu du script:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'#!/bin/bash\n# D\xe9claration des fonctions\nsource ~/mesfonctions\nread -p "Saisissez votre pr\xe9nom et votre nom (ex Marc Dubois) : " prenom \nnom\n# on appelle la fonction accueil du fichier ~/mesfonctions\nfunc_accueil "$prenom" "$nom"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"exemple",children:"Exemple"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'func_existe_user() {\n      grep -qi "^$1:" /etc/passwd && return 0     \n      return 1\n}\n \n#func_home_user() extrait le home directory d\'un utilisateur\nfunc_home_user() {\n    grep "^$1:" /etc/passwd | cut -d: -f6\n}\n \n# programme principal\nif [[ $# -eq 0 ]]; then\n      echo -e " Syntaxe: $0 <Entrez votre nom>" \n      exit 1\nif func_existe_user $1\nthen\n        home=$(func_home_user)\n    echo " $1 existe et son home directory est $home"\n    exit 10\nelse\n    echo "$1 n\'existe pas"\n    exit 20\nfi\n'})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>d});var i=s(6540);const r={},l=i.createContext(r);function c(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);